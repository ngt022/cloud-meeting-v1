import{_ as h,o as k,c as g,a as t,d as r,v as d,l as V,b as j,t as _,m as x,e as o,f as C,u as N,g as f}from"./index-CtQw4Fwj.js";const $={class:"join"},M={class:"container"},S={class:"form-group"},B={class:"form-group"},D={key:0,class:"form-group"},I=["disabled"],J={__name:"JoinView",setup(T){const p=x(),y=N(),s=o(""),a=o(""),i=o(""),l=o(!1),m=o(null),w=o(null),v=C(()=>s.value.trim()&&a.value.trim());k(()=>{p.params.no&&(s.value=p.params.no)});const b=async()=>{if(v.value)try{const e=await(await fetch(`/api/meetings/${s.value}`)).json();e.success?(w.value=e.data.meeting,m.value=e.data.meeting.id,l.value=!!e.data.meeting.password,l.value||c()):alert(e.message||"会议不存在")}catch{alert("检查会议失败")}},c=async()=>{try{const e=await(await fetch(`/api/meetings/${m.value}/join`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a.value,password:l.value?i.value:void 0})})).json();e.success?(localStorage.setItem("userName",a.value),y.push({path:`/meeting/${s.value}`,query:{name:a.value}})):alert(e.message||"加入失败")}catch{alert("加入失败")}};return(u,e)=>(f(),g("div",$,[t("div",M,[e[7]||(e[7]=t("h1",null,"加入会议",-1)),e[8]||(e[8]=t("p",{class:"version"},"v1.0.2",-1)),t("div",S,[e[4]||(e[4]=t("label",null,"会议号",-1)),r(t("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>s.value=n),placeholder:"请输入会议号",maxlength:"12"},null,512),[[d,s.value]])]),t("div",B,[e[5]||(e[5]=t("label",null,"您的名称",-1)),r(t("input",{"onUpdate:modelValue":e[1]||(e[1]=n=>a.value=n),placeholder:"请输入您的名称",maxlength:"20"},null,512),[[d,a.value]])]),l.value?(f(),g("div",D,[e[6]||(e[6]=t("label",null,"会议密码",-1)),r(t("input",{"onUpdate:modelValue":e[2]||(e[2]=n=>i.value=n),type:"password",placeholder:"请输入会议密码",onKeyup:V(c,["enter"])},null,544),[[d,i.value]])])):j("",!0),t("button",{class:"btn-primary",onClick:b,disabled:!v.value},_(l.value?"加入会议":"下一步"),9,I),t("button",{class:"btn-back",onClick:e[3]||(e[3]=n=>u.$router.push("/"))}," 返回首页 ")])]))}},K=h(J,[["__scopeId","data-v-786c8761"]]);export{K as default};
